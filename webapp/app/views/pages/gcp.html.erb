<%
  gac = ENV.fetch('GOOGLE_APPLICATION_CREDENTIALS', nil)
  bucket = ENV.fetch 'BUCKET_NAME', nil
  listing = gcp_bucket_listing(bucket) if (gac and bucket)
%>
<div>

<%= render partial: 'pages/gcp_rubyenv' rescue "Error with GCP RubyEnv" %>


<%= render partial: 'pages/gcp_gemini' rescue "Error with GCP Gemini" %>

<h1 class="font-bold text-4xl">â˜ï¸ GCP side</h1>

<h2>Some GCP stuff</h2>

<p>
  â˜ï¸ GOOGLE_APPLICATION_CREDENTIALS: <%= gac or 'ğŸ¤· not found' %>
</p>
<% if gac %>
  <p>
    â˜ï¸ Can i read the file '<%= gac %>' ? If so this is the byte size:
      <b>
        <%=File.exist?(gac) ? File.size(gac) : 'File doesnt exist'  %>
      </b>
  </p>
<% end %>
<p>
  â˜ï¸ BUCKET_NAME: gs://<%= ENV.fetch 'BUCKET_NAME', 'ğŸ¤· not found' %>
</p>

<h2>TODOs</h2>
<ul>
  <li>â˜ï¸ Add Cloud Run IAP</li>
</ul>

<% if bucket and gac %>
<h2>Gcloud ğŸ§ª experiments!</h2>

<p>
  â˜ï¸ Since we both have GAC and a buckets, let's read the GCS bucket ingo!
</p>
<p>
  â˜ï¸ TODO listing for ğŸª£ <%= bucket %><br/>
  <% listing.each do |file| %>
    ğŸ’¾ <tt><%= file %></tt><br/>
  <% end if listing.is_a? Array %>
</p>
<% end %>

<p>Content of Latest Manifest: TODO</p>

</div>
