<%
  gac = ENV.fetch('GOOGLE_APPLICATION_CREDENTIALS', nil)
  bucket = ENV.fetch 'BUCKET_NAME', nil
  listing = gcp_bucket_listing(bucket) if (gac and bucket)
%>
<div>
  <h1 class="font-bold text-4xl">â˜ï¸ GCP side</h1>

  <%#= image_tag 'geminews_mascotte.png', width: '300' %>

<h1>Some GCP stuff</h1>

<p>
  â˜ï¸ GOOGLE_APPLICATION_CREDENTIALS: <%= gac or 'ğŸ¤· not found' %>
</p
<p>
  â˜ï¸ Can i read the file? If so this is the byte size:
    <b>
      <%= File.exist?(gac) ? File.size(gac) : 'File doesnt exist' %>
    </b>
</p>
<p>
  â˜ï¸ BUCKET_NAME: gs://<%= ENV.fetch 'BUCKET_NAME', 'ğŸ¤· not found' %>
</p>

<h2>TODOs</h2>
<ul>
  <li>â˜ï¸ Add Cloud Run IAP</li>
</ul>

<% if bucket and gac %>
<h2>ğŸ§ª GcLoud experiments!</h2>

<p>
  â˜ï¸ Since we both have GAC and a bucket, lets read the bucket!
</p>
<p>
  â˜ï¸ TODO listing for ğŸª£ <%= bucket %><br/>
  <% listing.each do |file| %>
    ğŸ’¾ <tt><%= file %></tt><br/>
  <% end if listing.is_a? Array %>
</p>
<% end %>

<p>Content of Latest Manifest: TODO</p>

</div>
